-- ESP Script by Bing
-- Press Q to toggle ESP on or off
-- You can change the settings below

local ESP_ENABLED = true -- Whether the ESP is enabled by default
local ESP_KEY = Enum.KeyCode.Q -- The key to toggle the ESP
local ESP_COLOR = Color3.new(1, 0, 0) -- The color of the ESP text
local ESP_TRANSPARENCY = 0.5 -- The transparency of the ESP text
local ESP_OUTLINE = true -- Whether the ESP text has an outline
local ESP_OUTLINE_COLOR = Color3.new(0, 0, 0) -- The color of the ESP text outline
local ESP_OUTLINE_TRANSPARENCY = 0.5 -- The transparency of the ESP text outline
local ESP_SIZE = 16 -- The size of the ESP text
local ESP_FONT = Enum.Font.SourceSansBold -- The font of the ESP text
local ESP_TEAM_CHECK = true -- Whether the ESP only shows enemies

-- Do not edit below this line unless you know what you are doing

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

local function CreateESP(Player)
    local Character = Player.Character or Player.CharacterAdded:Wait()
    local Humanoid = Character:WaitForChild("Humanoid")
    local Head = Character:WaitForChild("Head")
    local BillboardGui = Instance.new("BillboardGui", Head)
    BillboardGui.Name = "ESP"
    BillboardGui.AlwaysOnTop = true
    BillboardGui.LightInfluence = 0
    BillboardGui.Size = UDim2.new(0, 200, 0, 50)
    BillboardGui.StudsOffset = Vector3.new(0, 2, 0)
    BillboardGui.Enabled = false
    local TextLabel = Instance.new("TextLabel", BillboardGui)
    TextLabel.Name = "Tag"
    TextLabel.BackgroundTransparency = 1
    TextLabel.Size = UDim2.new(1, 0, 1, 0)
    TextLabel.TextColor3 = ESP_COLOR
    TextLabel.TextTransparency = ESP_TRANSPARENCY
    TextLabel.TextStrokeColor3 = ESP_OUTLINE_COLOR
    TextLabel.TextStrokeTransparency = ESP_OUTLINE_TRANSPARENCY
    TextLabel.TextSize = ESP_SIZE
    TextLabel.Font = ESP_FONT
    TextLabel.TextScaled = true
    
    local function UpdateESP()
        if not Player or not Character or not Humanoid or not Head or not BillboardGui or not TextLabel then return end
        if Humanoid.Health <= 0 then
            BillboardGui.Enabled = false
            return
        end
        if Player == LocalPlayer then
            BillboardGui.Enabled = false
            return
        end
        if ESP_TEAM_CHECK and Player.TeamColor == LocalPlayer.TeamColor then
            BillboardGui.Enabled = false
            return
        end
        
        local ScreenPoint, OnScreen = Camera:WorldToScreenPoint(Head.Position)
        if OnScreen then
            BillboardGui.Enabled = true
            
            local MaxHealth = Humanoid.MaxHealth or 100
            local Health = Humanoid.Health or 0
            
            local HealthPercent = math.floor((Health / MaxHealth) * 100)
            local HealthText = HealthPercent .. "% " .. Health .. "/" .. MaxHealth
            
            TextLabel.Text = Player.Name .. "\n" .. HealthText
            
        else
            BillboardGui.Enabled = false
            
        end
        
    end
    
    UpdateESP()
    
    Humanoid.Died:Connect(function()
        BillboardGui:Destroy()
    end)
    
    RunService.RenderStepped:Connect(UpdateESP)
    
end

for i, v in pairs(Players:GetPlayers()) do
    CreateESP(v)
end

Players.PlayerAdded:Connect(function(v)
    CreateESP(v)
end)

UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == ESP_KEY then
        ESP_ENABLED = not ESP_ENABLED
        
        for i, v in pairs(Players:GetPlayers()) do
            
            local Character = v.Character or v.CharacterAdded:Wait()
            local Head = Character:WaitForChild("Head")
            local BillboardGui = Head:FindFirstChild("ESP")
            
            if BillboardGui then
                
                BillboardGui.Enabled = ESP_ENABLED
                
            end
            
        end
        
    end
    
end)

print("ESP Script loaded successfully!")
